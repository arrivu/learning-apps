<div id="wrap">

  <%= render 'shared/side_menu' %>
               
            <div id="content" style = "min-height: 300px;">
                <!-- .outer -->
                <div class="container-fluid outer" style="background:#fff;">
                            <div class="row-fluid">
                                                        <div class="span12 inner">
                            <!--Begin Datatables-->
                            <div class="row-fluid">
                                <div class="span12">
                                    <div class="box">
                                        <div id="collapse4" class="body">

   <div class="icons"><span class="badge badge-info">Course Management</span></div>

       <%= form_for :update_settings, :url => url_for(:controller => 'accounts', :action => 'update_settings')  do |f| %>




<ul class="nav nav-tabs" id="myTab">
 

  <li class="active"><a href="#price">Course Price</a></li>
   <li><a href="#edit">Course Edit</a></li>
  <li><a href="#manage">Manage Course</a></li>
  <li><a href="#preview">Course Preview</a></li>
   <li><a href="#module">Course Module</a></li>
  <li><a href="#section">Course Section</a></li>

</ul>

<div class="tab-content">

  
 <div class="tab-pane active" id="price">
 
   
   <table id="dataTable" class="table table-bordered table-condensed table-hover table-striped">
             <thead>
              <tr>
               <th >Course Name</th>
               <th > Start Date </th>
               <th >End Date</th>
               <th >Price</th>
               <th >Created At</th>
               <th style="text-align:center;"><%=t '.actions', :default => t("helpers.actions") %></th>
              </tr>
            </thead>
           

          <% @coursepricings = CoursePricing.all %>
         <% @coursepricings.each do |coursepricing| %>
         <tr> <td><%= coursepricing.course.title%></td>
          <td><%= coursepricing.start_date %></td>
          <td><%= coursepricing.end_date %></td>
          <td><%= coursepricing.price %></td>
          <td><%=l coursepricing.created_at, :format=>'%d %b. %Y %I:%M' %></td>
          <td> <%= link_to(edit_course_pricing_path(coursepricing)) do%><i class="icon icon-edit"></i><% end%></td>
          <td>
          <%= link_to(course_pricing_path(coursepricing),
                                   :method => :delete,
                      :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) ) do %>
           <i class="icon icon-trash"></i><% end %></td></tr>
         <% end %>
        </table>
 </div>

  
 
 <div class="tab-pane active" id="edit">
 
   
   <table id="dataTable" >
                   <%= simple_form_for(@course) do |f| %>
                    <%= render 'shared/error_messages', object: f.object %>
                    <tr><td><%= f.label :title, "Title" %></td>
                        <td><%= f.text_field :title %></td></tr>
                    <tr><td><%= f.label :start_date, "Start Date" %></td><td>
                            <%= f.input_field :start_date, :start_year => Date.today.year, :end_year => Date.today.year + 30, :order => [ :day, :month, :year], class:"date",style: "width: 84px;", :required => true %>
                        </td></tr>
                    <tr><td><%= f.label :end_date, "End Date" %></td><td>
                            <%= f.input_field :end_date, :start_year => Date.today.year, :end_year => Date.today.year + 30, :order => [ :day, :month, :year], class:"date",style: "width: 84px;", :required => true %>
                        </td></tr>
                        <% if current_user.has_role? :teacher %>
                            <%= f.hidden_field :teaching_staff_ids,:value=>current_user.teaching_staff.id%>
                        <% else  %>
                    <tr><td><%= f.label :teaching_staff_ids, "Author Name" %></td>
                            <td>
                            <%= f.collection_select :teaching_staff_ids, @domain_root_account.teaching_staffs.active.order(:name), :id, :name, {}, {multiple: false} %>
                            </td></tr>
                        <% end %>
                    <tr><td><%= f.label :short_desc, "Short Description" %></td>
                            <td><%= f.text_field :short_desc %></td></tr>
                    <tr><td><%= f.label :desc, "Course Description" %></td>
                            <td><%= f.text_area :desc ,:cols => "30", :rows => "10"%></td></tr>
                    <tr><td>  </td><td>
                                    <% if @course.data!=nil %>
                                    <%= image_tag url_for(:controller=>"courses", :action => 'show_image', :id =>      @course.id), :size => "100x100" %>
                                    <% end %>
                                </td></tr>
                    <tr><td><%= f.label 'attachment', "Image" %></td>
                                    <td><%= f.file_field 'attachment' %></td></tr>
                    <tr><td>  </td><td>
                                    <% if @course.background_image != nil %>
                                    <%= image_tag url_for(:controller=>"courses", :action => 'background_image', :id =>  @course.id), :size => "450x103" %>
                                <% end %>
                                </td></tr>
                    <tr><td><%= f.label 'background', "Background Image (1350x310)" %></td>
                                <td><%= f.file_field 'background' %></td></tr>
                    <tr><td><%= f.label :ispopular, "Popular" %></td>
                                <td><%= f.check_box :ispopular %></td></tr>
                    <tr><td><%= f.label :ispublished, "Publish" %></td>
                                <td><%= f.check_box :ispublished  %></td></tr>
                    <tr><td><%= f.label :is_coming_soon, "Coming Soon" %></td>
                                <td><%= f.check_box :is_coming_soon %></td></tr>
                    <tr><td><%= f.label :topic_id, "Topics" %></td>
                    <td><%= f.collection_select :topic_id,@domain_root_account.topics.order(:name), :id, :name, {}, {multiple: false} %></td></tr>
                    <tr> <td>        <%= f.label :tag_tokens, "Update Tags" %></td>
                         <td>
                           <div class="field">
         <%= f.text_field :tag_tokens, :class => "token_input", "data-pre" => @course.tags.map(&:attributes).to_json %>

                           </div>
                         </td>
                         </tr>
                   <tr><td></td><td><%= f.submit "Update Course", class: "btn btn-large btn-primary" %>
                       </td></tr>
                    <% end %>
                </table>
 </div>

  

  <div class="tab-pane" id="manage">
    <table id="dataTable" class="table table-bordered table-condensed table-hover table-striped">
        <thead>
       <tr class="tab_head">
      <th></th>
      <%- model_class = Course -%>
      <th>Category</th>
      <th><%= model_class.human_attribute_name(:title) %></th>
      <th><%= model_class.human_attribute_name(:start_date) %></th>
      <th><%= model_class.human_attribute_name(:end_date) %></th>
      <th><%= model_class.human_attribute_name(:created_at) %></th>
      <th><%=t '.action', :default => t("helpers.action") %></th>
    </tr>
  </thead>
  <tbody>

    <% @courses.each do |course| %>
    <tr>
      <td><%= image_tag course.course_image.url(:small) %></td>
      <td><%= course.topic.name %></td> 
        <td><%= link_to course.title, course_path(course) %></td>
        <td><%= course.start_date %></td>
        <td><%= course.end_date %></td>
        <td><%=l course.created_at, :format=>'%d %b. %Y %I:%M' %></td>
        <td>
          <%= link_to(edit_course_path(course)) do%><i class="icon icon-edit"></i><% end%>
        
        
          <%=hidden_field t('.destroy', :default => t("helpers.links.destroy")),
          course_path(course),
          :method => :delete,
          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
          :class => 'btn btn-mini btn-danger' %>
        </td>
      </tr>
      <% end %>
   


  </tbody>

</table>
  </div>

  <div class="tab-pane" id="preview">
   <table id="dataTable" class="table table-bordered table-condensed table-hover table-striped">
      <thead>
          <tr class="tab_head">
            <th>Course </th>
            <th>Title</th>
            <th>Description</th>
            <th>Display Order</th>
            <th>Created At</th>

<th style="text-align:center;"><%=t '.actions', :default => t("helpers.actions") %></th>          </tr>
        </thead>
        <tbody>
          <% @previews = CoursePreview.all %>
          <% @previews.each do |preview| %>
          <tr>
            <td><%= preview.course.title %></td>
            <td><%= preview.name %></td>
            <td><%= preview.desc %></td>
            <td><%= preview.sequence %></td>
            <td><%=l preview.created_at, :format=>'%d %b. %Y %I:%M' %></td>

<td> <%= link_to(edit_course_preview_path(preview)) do%><i class="icon icon-edit"></i><% end%>

    </td> 
    <td>
    <%= link_to(course_preview_path(preview),
                                   :method => :delete,
                      :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) ) do %>
           <i class="icon icon-trash"></i>
          <% end %>
        </td>
          </tr>
          <% end %>
        </tbody>
      </table>

  </div>


   <!-- <div class="tab-pane" id="status">
   <%= form_tag "/course_status_search", :method => 'get' do %>

           

               Course: <%= select_tag :search, options_from_collection_for_select(Course.where(:account_id=>@account_id), "id", "title",:selected => params[:search]) , {:prompt => 'ALL'} %>
            
              
              Status:
              <%= select_tag(:searchstatus, options_for_select(['All','enroll','completed'],:selected => params[:searchstatus])) %>

              <%= submit_tag "Search", :name => nil,class:"btn btn-large btn-primary", :style=> "margin-top: -11px" %><% end %>
                                           
      <table id="dataTable" class="table table-bordered table-condensed table-hover table-striped">
        <tr class="tab_head">
                <th style="color:block;">Course Name</th>
                <th style="color:block;">Student</th>
                <th style="color:block;">Status</th>
                <th style="color:block;">Action</th>
              </tr>
              

          
           </table>

  </div>
  

 -->
  <div class="tab-pane" id="module">
    
  <table id="dataTable" class="table table-bordered table-condensed table-hover table-striped">
  <thead>
                                                  
      <tr class="tab_head">
        <th >Module</th>
      <th style="text-align:center;"><%=t '.actions', :default => t("helpers.actions") %></th> 
         </tr>
    </thead>
    <tbody>
      <% @course_module = CourseModule.all %>
  <% @course_module.each do |mod| %>
  <tr>
  <td>
    <%= mod.course_module %>
  </td>
  
  
 <td> <%= link_to(edit_course_module_path(mod)) do%><i class="icon icon-edit"></i><% end%>

    </td> 

    <td>
    <%= link_to(course_module_path(mod),
     :method => :delete,:confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) ) do %>
           <i class="icon icon-trash"></i>
          <% end %>
        </td>

 </tr>
 <%end%>
                         </table>
  </div>

<div class="tab-pane" id="section">
  

  <table id="dataTable" class="table table-bordered table-condensed table-hover table-striped">
  <thead>
                                                  
      <tr class="tab_head">
        <th >Section</th>
      <th style="text-align:center;"><%=t '.actions', :default => t("helpers.actions") %></th> 
         </tr>
    </thead>
    <tbody>
 
 <% @section = Section.all %>
  <% @section.each do |sect| %>
  <tr>
  <td>
    <%= sect.section %>
  </td>
  
  
 <td> <%= link_to(edit_section_path(sect)) do%><i class="icon icon-edit"></i><% end%>

    </td> 

    <td>
    <%= link_to(section_path(sect),
     :method => :delete,:confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) ) do %>
           <i class="icon icon-trash"></i>
          <% end %>
        </td>

 </tr>
 <%end%>
                         </table>


  </div>

</div> <br>



<script>
  $('#myTab a').click(function (e) {
  e.preventDefault();
  $(this).tab('show');
})
</script>
   
        
<% end %>
                                       </div>
                                    </div>
                                </div>
                            </div> 
                                
                            
                        
                    </div>
                    <!-- /.row-fluid -->
                </div>
                <!-- /.outer -->
            </div></div>
            <!-- END CONTENT -->
 <!-- <div id="nestedAccordion" style="float: left;"> -->
  <div class="left" >  

<a href= <%= new_course_path%> class="btn btn-default btn-large"><i class="icon icon-plus-sign"></i>Add Course</a>

<a href= <%= new_course_pricing_path%> class="btn btn-default btn-large"><i class="icon icon-plus-sign"></i>Add Price</a>

<a href= <%=new_course_preview_path%> class="btn btn-default btn-large"><i class="icon icon-plus-sign"></i>Add Preview</a> 

<a href= <%=conclude_course_path%> class="btn btn-default btn-large"><i class="icon icon-lock"></i>Conclude Course</a> 

<a href= <%=course_status_search_path%> class="btn btn-default btn-large"><i class="icon icon-search"></i>Course Status</a> 

<a href= <%= new_section_path %> class="btn btn-default btn-large"><i class="icon icon-plus-sign"></i>Add Section</a> 

<a href= <%= new_course_module_path %> class="btn btn-default btn-large"><i class="icon icon-plus-sign"></i>Add Module</a> 

</div>
            <!-- #push do not remove -->
            <div id="push"></div>
            <!-- /#push -->
        
        <!-- END WRAP -->

        <div class="clearfix"></div>
       


    </div>
